# 网络安全工具集

## 项目简介

网络安全运维一体化工具集，专为安全研究人员和网络管理员设计。主要应用场景包括：
- 企业内部网络监控与异常检测
- 渗透测试中的信息收集阶段
- 教学演示网络协议工作原理
- 日常运维中的服务健康检查

核心组件基于PyQt5框架开发，采用分层架构设计：
```
└── 展示层（GUI界面）
    └── 业务层（功能模块）
        └── 数据层（Scapy/cryptography）
```
基于PyQt5开发的网络安防工具套件，集成ARP欺骗检测、SSL/TLS分析、端口扫描、DNS监控等实用功能。

## 功能特性

### 模块技术实现
1. **ARP欺骗检测模块**  
   - 使用Scapy库监听ARP响应包
   - 建立MAC-IP绑定数据库
   - 异常流量阈值：15包/秒
   - 实时告警推送桌面通知

2. **SSL/TLS分析器**  
   - 基于cryptography解析证书链
   - 支持SNI扩展检测
   - 证书有效性检查（OCSP装订）
   - 支持TLS 1.3协议分析

3. **智能端口扫描器**  
   - 自适应TCP SYN/ACK扫描
   - 服务指纹识别（nmap风格）
   - 多线程池管理（默认50线程）
   - 结果自动分类存储

4. **DNS流量监控**  
   - libpcap原始套接字捕获
   - 支持53端口UDP/TCP协议
   - 查询类型统计分析
   - 异常域名模式检测

- ARP欺骗实时检测与告警
- SSL/TLS证书链分析
- 多线程端口扫描器
- DNS查询流量监控
- 友好的GUI操作界面

## 环境要求
- Python 3.8+
- PyQt5
- scapy
- cryptography

## 安装步骤

### 多平台依赖安装
```bash
# 通用依赖
pip install -r requirements.txt

# Linux系统
sudo apt install libpcap-dev tshark  # Debian/Ubuntu
sudo yum install libpcap-devel wireshark  # RHEL/CentOS

# macOS系统
brew install libpcap wireshark
```
```bash
git clone https://github.com/your-repo/Network-Security.git
cd Network-Security
pip install -r requirements.txt
```

## 使用方法

### 通用操作指南
1. 启动程序
```bash
# 普通用户模式
python main_window.py

# 需要抓包权限的模式（Linux/macOS）
sudo python main_window.py
```

### 功能模块详解

#### 1. ARP欺骗检测模块
**参数说明**:
- 网络接口名称：
  - 有线网络示例：eth0/en0
  - 无线网络示例：wlan0/wlp3s0
  - 可使用`ifconfig`(Unix)或`ipconfig`(Windows)查询

**操作流程**:
1. 在接口输入框输入网络接口名称
2. 点击【开始检测】启动监控
3. 检测到异常时，界面会：
   - 弹出桌面通知
   - 日志区显示红色告警信息
   - 流量图表显示实时波动

**配置示例**:
```
# 家庭无线网络环境
接口名称：wlan0
检测阈值：15包/秒

# 企业有线网络环境 
接口名称：eth0
检测阈值：30包/秒
```

#### 2. 智能端口扫描器
**参数规范**:
- 目标IP格式：
  - IPv4地址（192.168.1.1）
  - 域名（example.com）
- 端口范围：
  - 单端口：80
  - 连续范围：1-1024
  - 多个范围：80,443,8000-8080

**界面指引**:
1. 目标地址输入框支持CIDR格式（192.168.1.0/24）
2. 点击【导出结果】可生成CSV报告
3. 进度条显示当前扫描完成度

**典型场景**:
```
# 快速扫描常用端口
目标IP：10.0.0.1
端口范围：21,22,80,443,3389

# 全面扫描测试环境
目标IP：192.168.56.102
端口范围：1-65535
```

#### 3. SSL/TLS分析器
**高级参数**:
- 支持指定SSL版本：
  - TLS 1.2（默认）
  - TLS 1.3
  - 兼容模式
- 证书链深度检测：
  - 完整验证（默认）
  - 快速验证

**操作演示**:
1. 输入目标域名：example.com:443
2. 勾选【深度分析】复选框
3. 点击【开始分析】后：
   - 显示证书颁发机构链
   - 标红显示过期证书
   - 显示支持的加密套件

#### 4. DNS监控模块
**网络环境配置**:
```
# 企业网络环境（镜像端口）
监控接口：eth0
过滤规则：port 53

# 无线热点环境
监控接口：wlan0
过滤规则：udp and port 53
```

**界面元素说明**:
- 【开始监控】按钮：启动DNS查询捕获
- 【过滤设置】按钮：设置域名白名单
- 【导出日志】按钮：保存查询记录
- 统计面板：显示各类型查询占比

### 典型应用场景

#### 场景1：内网ARP欺骗检测
1. 选择有线接口eth0
2. 设置检测阈值为20包/秒
3. 持续监控10分钟后...
4. 发现192.168.1.15的异常ARP响应
5. 使用【导出证据】功能保存日志

#### 场景2：外网SSL证书分析
1. 输入https://example.com
2. 选择TLS 1.3协议版本
3. 发现证书链不完整告警
4. 使用【保存报告】生成PDF分析结果

#### 场景3：无线网络端口扫描
1. 连接wifi_guest网络
2. 扫描192.168.0.1-192.168.0.254
3. 发现192.168.0.102开放异常端口31337
4. 使用【标记风险】功能记录可疑主机

## 注意事项

### 法律声明与使用规范
1. 本工具仅限授权测试使用
2. ARP检测功能不可用于主动扫描他人网络
3. 端口扫描需获得目标明确授权
4. 禁止将本工具用于非法渗透测试

### 界面操作指引
```
[主界面示意图]
+-----------------------------+
| 网络接口选择 | 开始监控按钮 |
+-----------------------------+
| 实时流量图表区域            |
+-----------------------------+
| 事件日志列表（可导出CSV）   |
+-----------------------------+
```

- 启动时自动检测权限，权限不足时会弹出可视化警告窗口
- 执行需要权限的功能时会进行二次确认提示
- 部分功能需要管理员权限运行（需使用sudo启动程序）
- ARP检测仅支持有线网络接口
- 端口扫描请遵守当地网络安全法规
- SSL分析支持标准443端口服务

## 新增权限提示说明
当程序检测到权限不足时，会主动弹出以下提示：
1. **启动时权限检测**  
   - 非管理员启动时显示黄色警告弹窗  
   - 提示文字："部分功能需要管理员权限运行！\n请使用sudo重新启动程序以获得完整功能。"

2. **功能执行前二次确认**  
   - 当尝试执行ARP检测等需要权限的功能时  
   - 显示红色错误弹窗  
   - 提示文字："ARP欺骗检测需要管理员权限！\n请使用sudo重新启动程序。"

界面提示效果请参考项目文档中的`permission_warning.png`截图文件。

## 许可证
MIT License

## 贡献指南
欢迎提交Issue和Pull Request，请遵循现有代码风格